[2024-08-07T07:48:34.392+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-08-07T07:48:34.405+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: test.pred_Categorical manual__2024-08-07T07:48:31.858098+00:00 [queued]>
[2024-08-07T07:48:34.410+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: test.pred_Categorical manual__2024-08-07T07:48:31.858098+00:00 [queued]>
[2024-08-07T07:48:34.410+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-08-07T07:48:34.418+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): pred_Categorical> on 2024-08-07 07:48:31.858098+00:00
[2024-08-07T07:48:34.426+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=1625) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-08-07T07:48:34.428+0000] {standard_task_runner.py:64} INFO - Started process 1636 to run task
[2024-08-07T07:48:34.429+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'test', 'pred_Categorical', 'manual__2024-08-07T07:48:31.858098+00:00', '--job-id', '859', '--raw', '--subdir', 'DAGS_FOLDER/test.py', '--cfg-path', '/tmp/tmp02r91_es']
[2024-08-07T07:48:34.432+0000] {standard_task_runner.py:91} INFO - Job 859: Subtask pred_Categorical
[2024-08-07T07:48:34.470+0000] {task_command.py:426} INFO - Running <TaskInstance: test.pred_Categorical manual__2024-08-07T07:48:31.858098+00:00 [running]> on host de0da25eb647
[2024-08-07T07:48:34.514+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='***@example.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='test' AIRFLOW_CTX_TASK_ID='pred_Categorical' AIRFLOW_CTX_EXECUTION_DATE='2024-08-07T07:48:31.858098+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-08-07T07:48:31.858098+00:00'
[2024-08-07T07:48:34.516+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-08-07T07:48:34.634+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,634 botocore.hooks [DEBUG] Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0xffff78c66520>
[2024-08-07T07:48:34.634+0000] {hooks.py:238} DEBUG - Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0xffff78c66520>
[2024-08-07T07:48:34.635+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,635 botocore.hooks [DEBUG] Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0xffff78c84720>
[2024-08-07T07:48:34.635+0000] {hooks.py:238} DEBUG - Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0xffff78c84720>
[2024-08-07T07:48:34.635+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,635 botocore.hooks [DEBUG] Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:48:34.635+0000] {hooks.py:238} DEBUG - Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:48:34.636+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,636 botocore.hooks [DEBUG] Event before-parameter-build.s3.CreateBucket: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:48:34.636+0000] {hooks.py:238} DEBUG - Event before-parameter-build.s3.CreateBucket: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:48:34.636+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,636 botocore.hooks [DEBUG] Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0xffff78c66340>
[2024-08-07T07:48:34.636+0000] {hooks.py:238} DEBUG - Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0xffff78c66340>
[2024-08-07T07:48:34.637+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,637 botocore.hooks [DEBUG] Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffff78c84900>
[2024-08-07T07:48:34.637+0000] {hooks.py:238} DEBUG - Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffff78c84900>
[2024-08-07T07:48:34.637+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,637 botocore.hooks [DEBUG] Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:48:34.637+0000] {hooks.py:238} DEBUG - Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:48:34.638+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,638 botocore.regions [DEBUG] Calling endpoint provider with parameters: {'Bucket': 'my-bucket-name', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'Endpoint': 'http://host.docker.internal:9001', 'ForcePathStyle': True, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True, 'UseS3ExpressControlEndpoint': True}
[2024-08-07T07:48:34.638+0000] {regions.py:498} DEBUG - Calling endpoint provider with parameters: {'Bucket': 'my-bucket-name', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'Endpoint': 'http://host.docker.internal:9001', 'ForcePathStyle': True, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True, 'UseS3ExpressControlEndpoint': True}
[2024-08-07T07:48:34.640+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,640 botocore.regions [DEBUG] Endpoint provider result: http://host.docker.internal:9001/my-bucket-name
[2024-08-07T07:48:34.640+0000] {regions.py:513} DEBUG - Endpoint provider result: http://host.docker.internal:9001/my-bucket-name
[2024-08-07T07:48:34.641+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,641 botocore.regions [DEBUG] Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
[2024-08-07T07:48:34.641+0000] {regions.py:660} DEBUG - Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
[2024-08-07T07:48:34.642+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,642 botocore.regions [DEBUG] Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
[2024-08-07T07:48:34.642+0000] {regions.py:733} DEBUG - Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
[2024-08-07T07:48:34.643+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,643 botocore.hooks [DEBUG] Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0xffff78c668e0>
[2024-08-07T07:48:34.643+0000] {hooks.py:238} DEBUG - Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0xffff78c668e0>
[2024-08-07T07:48:34.644+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,644 botocore.hooks [DEBUG] Event before-call.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:48:34.644+0000] {hooks.py:238} DEBUG - Event before-call.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:48:34.644+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,644 botocore.hooks [DEBUG] Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0xffff78c65800>
[2024-08-07T07:48:34.644+0000] {hooks.py:238} DEBUG - Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0xffff78c65800>
[2024-08-07T07:48:34.645+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,645 botocore.hooks [DEBUG] Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0xffff78c67e20>
[2024-08-07T07:48:34.645+0000] {hooks.py:238} DEBUG - Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0xffff78c67e20>
[2024-08-07T07:48:34.645+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,645 botocore.endpoint [DEBUG] Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource'}, 'body': b'', 'auth_path': '/my-bucket-name/', 'url': 'http://host.docker.internal:9001/my-bucket-name', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff475bc050>, 'has_streaming_input': False, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'my-bucket-name', 'params': {'Bucket': 'my-bucket-name'}}, 'input_params': {'Bucket': 'my-bucket-name'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
[2024-08-07T07:48:34.645+0000] {endpoint.py:114} DEBUG - Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource'}, 'body': b'', 'auth_path': '/my-bucket-name/', 'url': 'http://host.docker.internal:9001/my-bucket-name', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff475bc050>, 'has_streaming_input': False, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'my-bucket-name', 'params': {'Bucket': 'my-bucket-name'}}, 'input_params': {'Bucket': 'my-bucket-name'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
[2024-08-07T07:48:34.646+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,646 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:48:34.646+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:48:34.647+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,646 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:48:34.646+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:48:34.647+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,647 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:48:34.647+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:48:34.648+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,648 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:48:34.648+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:48:34.648+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,648 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:48:34.648+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:48:34.649+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,649 botocore.auth [DEBUG] Calculating signature using v4 auth.
[2024-08-07T07:48:34.649+0000] {auth.py:425} DEBUG - Calculating signature using v4 auth.
[2024-08-07T07:48:34.649+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,649 botocore.auth [DEBUG] CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T074834Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:48:34.649+0000] {auth.py:426} DEBUG - CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T074834Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:48:34.650+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,650 botocore.auth [DEBUG] StringToSign:
AWS4-HMAC-SHA256
20240807T074834Z
20240807/us-east-1/s3/aws4_request
785e45d240d6bb16f88fb3a1cb04ae9e461c4f5f6184e04945a159b41d5dd22a
[2024-08-07T07:48:34.650+0000] {auth.py:428} DEBUG - StringToSign:
AWS4-HMAC-SHA256
20240807T074834Z
20240807/us-east-1/s3/aws4_request
785e45d240d6bb16f88fb3a1cb04ae9e461c4f5f6184e04945a159b41d5dd22a
[2024-08-07T07:48:34.650+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,650 botocore.auth [DEBUG] Signature:
6c36054ad5e920fd95ada1d76792a6ec7f57ab42e19b183bc1ee6e39e28d11c8
[2024-08-07T07:48:34.650+0000] {auth.py:430} DEBUG - Signature:
6c36054ad5e920fd95ada1d76792a6ec7f57ab42e19b183bc1ee6e39e28d11c8
[2024-08-07T07:48:34.651+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,651 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:48:34.651+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:48:34.653+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:48:34,651 botocore.endpoint [DEBUG] Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T074834Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=6c36054ad5e920fd95ada1d76792a6ec7f57ab42e19b183bc1ee6e39e28d11c8', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
[2024-08-07T07:48:34.651+0000] {endpoint.py:265} DEBUG - Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T074834Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=6c36054ad5e920fd95ada1d76792a6ec7f57ab42e19b183bc1ee6e39e28d11c8', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
[2024-08-07T07:49:04.666+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:04,666 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:49:04.666+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:49:04.679+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:04,671 botocore.retryhandler [DEBUG] retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:49:04.671+0000] {retryhandler.py:311} DEBUG - retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:49:04.682+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:04,681 botocore.retryhandler [DEBUG] Retry needed, action of: 0.9462463072351421
[2024-08-07T07:49:04.681+0000] {retryhandler.py:209} DEBUG - Retry needed, action of: 0.9462463072351421
[2024-08-07T07:49:04.692+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:04,691 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:49:04.691+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:49:04.692+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:04,692 botocore.endpoint [DEBUG] Response received to retry, sleeping for 0.9462463072351421 seconds
[2024-08-07T07:49:04.692+0000] {endpoint.py:369} DEBUG - Response received to retry, sleeping for 0.9462463072351421 seconds
[2024-08-07T07:49:05.645+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,644 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:49:05.644+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:49:05.648+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,648 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:49:05.648+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:49:05.650+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,650 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:49:05.650+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:49:05.651+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,651 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:49:05.651+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:49:05.653+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,652 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:49:05.652+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:49:05.654+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,654 botocore.auth [DEBUG] Calculating signature using v4 auth.
[2024-08-07T07:49:05.654+0000] {auth.py:425} DEBUG - Calculating signature using v4 auth.
[2024-08-07T07:49:05.655+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,655 botocore.auth [DEBUG] CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T074905Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:49:05.655+0000] {auth.py:426} DEBUG - CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T074905Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:49:05.656+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,656 botocore.auth [DEBUG] StringToSign:
AWS4-HMAC-SHA256
20240807T074905Z
20240807/us-east-1/s3/aws4_request
c79fda3b68b296fe662e5cdea6957a8a8bff820022775db94118eabaf05fe457
[2024-08-07T07:49:05.656+0000] {auth.py:428} DEBUG - StringToSign:
AWS4-HMAC-SHA256
20240807T074905Z
20240807/us-east-1/s3/aws4_request
c79fda3b68b296fe662e5cdea6957a8a8bff820022775db94118eabaf05fe457
[2024-08-07T07:49:05.657+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,657 botocore.auth [DEBUG] Signature:
e16e9a1c36d431a9cce23dd384f296e729657aaa67b4954babc02d0be4e34b2d
[2024-08-07T07:49:05.657+0000] {auth.py:430} DEBUG - Signature:
e16e9a1c36d431a9cce23dd384f296e729657aaa67b4954babc02d0be4e34b2d
[2024-08-07T07:49:05.658+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,658 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:49:05.658+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:49:05.659+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:05,659 botocore.endpoint [DEBUG] Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T074905Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=e16e9a1c36d431a9cce23dd384f296e729657aaa67b4954babc02d0be4e34b2d', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=2; max=5', 'Content-Length': '0'}>
[2024-08-07T07:49:05.659+0000] {endpoint.py:265} DEBUG - Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T074905Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=e16e9a1c36d431a9cce23dd384f296e729657aaa67b4954babc02d0be4e34b2d', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=2; max=5', 'Content-Length': '0'}>
[2024-08-07T07:49:35.670+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:35,669 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:49:35.669+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:49:35.679+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:35,674 botocore.retryhandler [DEBUG] retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:49:35.674+0000] {retryhandler.py:311} DEBUG - retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:49:35.681+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:35,681 botocore.retryhandler [DEBUG] Retry needed, action of: 1.3624101933932202
[2024-08-07T07:49:35.681+0000] {retryhandler.py:209} DEBUG - Retry needed, action of: 1.3624101933932202
[2024-08-07T07:49:35.683+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:35,682 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:49:35.682+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:49:35.684+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:35,684 botocore.endpoint [DEBUG] Response received to retry, sleeping for 1.3624101933932202 seconds
[2024-08-07T07:49:35.684+0000] {endpoint.py:369} DEBUG - Response received to retry, sleeping for 1.3624101933932202 seconds
[2024-08-07T07:49:37.049+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,049 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:49:37.049+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:49:37.052+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,052 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:49:37.052+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:49:37.054+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,054 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:49:37.054+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:49:37.056+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,056 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:49:37.056+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:49:37.057+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,057 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:49:37.057+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:49:37.059+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,059 botocore.auth [DEBUG] Calculating signature using v4 auth.
[2024-08-07T07:49:37.059+0000] {auth.py:425} DEBUG - Calculating signature using v4 auth.
[2024-08-07T07:49:37.060+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,060 botocore.auth [DEBUG] CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T074937Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:49:37.060+0000] {auth.py:426} DEBUG - CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T074937Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:49:37.062+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,061 botocore.auth [DEBUG] StringToSign:
AWS4-HMAC-SHA256
20240807T074937Z
20240807/us-east-1/s3/aws4_request
39ce0b20097e19ad88a4a2c7f126247609b04d8f20a97ae64f2a554d285b3faf
[2024-08-07T07:49:37.061+0000] {auth.py:428} DEBUG - StringToSign:
AWS4-HMAC-SHA256
20240807T074937Z
20240807/us-east-1/s3/aws4_request
39ce0b20097e19ad88a4a2c7f126247609b04d8f20a97ae64f2a554d285b3faf
[2024-08-07T07:49:37.063+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,062 botocore.auth [DEBUG] Signature:
3ce021704ea9aa00384085a0984107ed07aa8438ecf75fcd2781d3fb58638b0f
[2024-08-07T07:49:37.062+0000] {auth.py:430} DEBUG - Signature:
3ce021704ea9aa00384085a0984107ed07aa8438ecf75fcd2781d3fb58638b0f
[2024-08-07T07:49:37.063+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,063 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:49:37.063+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:49:37.064+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:49:37,064 botocore.endpoint [DEBUG] Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T074937Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=3ce021704ea9aa00384085a0984107ed07aa8438ecf75fcd2781d3fb58638b0f', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=3; max=5', 'Content-Length': '0'}>
[2024-08-07T07:49:37.064+0000] {endpoint.py:265} DEBUG - Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T074937Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=3ce021704ea9aa00384085a0984107ed07aa8438ecf75fcd2781d3fb58638b0f', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=3; max=5', 'Content-Length': '0'}>
[2024-08-07T07:50:07.072+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:07,072 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:50:07.072+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:50:07.078+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:07,075 botocore.retryhandler [DEBUG] retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:50:07.075+0000] {retryhandler.py:311} DEBUG - retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:50:07.080+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:07,080 botocore.retryhandler [DEBUG] Retry needed, action of: 2.4136959686694825
[2024-08-07T07:50:07.080+0000] {retryhandler.py:209} DEBUG - Retry needed, action of: 2.4136959686694825
[2024-08-07T07:50:07.081+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:07,081 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:50:07.081+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:50:07.081+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:07,081 botocore.endpoint [DEBUG] Response received to retry, sleeping for 2.4136959686694825 seconds
[2024-08-07T07:50:07.081+0000] {endpoint.py:369} DEBUG - Response received to retry, sleeping for 2.4136959686694825 seconds
[2024-08-07T07:50:09.498+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,497 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:50:09.497+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:50:09.501+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,500 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:50:09.500+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:50:09.503+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,502 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:50:09.502+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:50:09.504+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,504 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:50:09.504+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:50:09.506+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,506 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:50:09.506+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:50:09.508+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,508 botocore.auth [DEBUG] Calculating signature using v4 auth.
[2024-08-07T07:50:09.508+0000] {auth.py:425} DEBUG - Calculating signature using v4 auth.
[2024-08-07T07:50:09.510+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,510 botocore.auth [DEBUG] CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T075009Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:50:09.510+0000] {auth.py:426} DEBUG - CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T075009Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:50:09.511+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,511 botocore.auth [DEBUG] StringToSign:
AWS4-HMAC-SHA256
20240807T075009Z
20240807/us-east-1/s3/aws4_request
f3f39cfff937387c04cdb633131650410aba46ffee8821c9dab83e7b0f272baf
[2024-08-07T07:50:09.511+0000] {auth.py:428} DEBUG - StringToSign:
AWS4-HMAC-SHA256
20240807T075009Z
20240807/us-east-1/s3/aws4_request
f3f39cfff937387c04cdb633131650410aba46ffee8821c9dab83e7b0f272baf
[2024-08-07T07:50:09.512+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,512 botocore.auth [DEBUG] Signature:
4f79a3881d3fcc08891aca43a5738c830fb4b8865cbbbfaa797b43b06ecdd711
[2024-08-07T07:50:09.512+0000] {auth.py:430} DEBUG - Signature:
4f79a3881d3fcc08891aca43a5738c830fb4b8865cbbbfaa797b43b06ecdd711
[2024-08-07T07:50:09.513+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,513 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:50:09.513+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:50:09.514+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:09,514 botocore.endpoint [DEBUG] Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T075009Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=4f79a3881d3fcc08891aca43a5738c830fb4b8865cbbbfaa797b43b06ecdd711', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=4; max=5', 'Content-Length': '0'}>
[2024-08-07T07:50:09.514+0000] {endpoint.py:265} DEBUG - Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T075009Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=4f79a3881d3fcc08891aca43a5738c830fb4b8865cbbbfaa797b43b06ecdd711', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=4; max=5', 'Content-Length': '0'}>
[2024-08-07T07:50:39.523+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:39,523 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:50:39.523+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:50:39.525+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:39,524 botocore.retryhandler [DEBUG] retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:50:39.524+0000] {retryhandler.py:311} DEBUG - retry needed, retryable exception caught: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 307, in _should_retry
    return self._checker(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:50:39.526+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:39,526 botocore.retryhandler [DEBUG] Retry needed, action of: 1.4618541869586998
[2024-08-07T07:50:39.526+0000] {retryhandler.py:209} DEBUG - Retry needed, action of: 1.4618541869586998
[2024-08-07T07:50:39.526+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:39,526 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:50:39.526+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff4749dbb0>>
[2024-08-07T07:50:39.527+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:39,527 botocore.endpoint [DEBUG] Response received to retry, sleeping for 1.4618541869586998 seconds
[2024-08-07T07:50:39.527+0000] {endpoint.py:369} DEBUG - Response received to retry, sleeping for 1.4618541869586998 seconds
[2024-08-07T07:50:40.992+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,991 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:50:40.991+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff47694980>>
[2024-08-07T07:50:40.994+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,993 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:50:40.993+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffab6acf50>>
[2024-08-07T07:50:40.995+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,995 botocore.hooks [DEBUG] Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:50:40.995+0000] {hooks.py:238} DEBUG - Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff78c66200>
[2024-08-07T07:50:40.996+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,996 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:50:40.996+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff78c84860>
[2024-08-07T07:50:40.997+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,996 botocore.hooks [DEBUG] Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:50:40.996+0000] {hooks.py:238} DEBUG - Event before-sign.s3.CreateBucket: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0xffffa6d300e0>>
[2024-08-07T07:50:40.998+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,998 botocore.auth [DEBUG] Calculating signature using v4 auth.
[2024-08-07T07:50:40.998+0000] {auth.py:425} DEBUG - Calculating signature using v4 auth.
[2024-08-07T07:50:40.999+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,999 botocore.auth [DEBUG] CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T075040Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:50:40.999+0000] {auth.py:426} DEBUG - CanonicalRequest:
PUT
/my-bucket-name

host:host.docker.internal:9001
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20240807T075040Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
[2024-08-07T07:50:40.999+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:40,999 botocore.auth [DEBUG] StringToSign:
AWS4-HMAC-SHA256
20240807T075040Z
20240807/us-east-1/s3/aws4_request
2d4f9d47b92558487f22405576ffdee786d1bd3c4f13a26285b2a3cb7369f2ad
[2024-08-07T07:50:40.999+0000] {auth.py:428} DEBUG - StringToSign:
AWS4-HMAC-SHA256
20240807T075040Z
20240807/us-east-1/s3/aws4_request
2d4f9d47b92558487f22405576ffdee786d1bd3c4f13a26285b2a3cb7369f2ad
[2024-08-07T07:50:41.000+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:41,000 botocore.auth [DEBUG] Signature:
b222355c31a90a93a7ed23d9fd5164a225d92fa3ef4b8490f88657d3ba4a73df
[2024-08-07T07:50:41.000+0000] {auth.py:430} DEBUG - Signature:
b222355c31a90a93a7ed23d9fd5164a225d92fa3ef4b8490f88657d3ba4a73df
[2024-08-07T07:50:41.001+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:41,001 botocore.hooks [DEBUG] Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:50:41.001+0000] {hooks.py:238} DEBUG - Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff78c84680>
[2024-08-07T07:50:41.002+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:50:41,001 botocore.endpoint [DEBUG] Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T075040Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=b222355c31a90a93a7ed23d9fd5164a225d92fa3ef4b8490f88657d3ba4a73df', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=5; max=5', 'Content-Length': '0'}>
[2024-08-07T07:50:41.001+0000] {endpoint.py:265} DEBUG - Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=http://host.docker.internal:9001/my-bucket-name, headers={'User-Agent': b'Boto3/1.34.131 md/Botocore#1.34.131 ua/2.0 os/linux#6.6.26-linuxkit md/arch#aarch64 lang/python#3.12.4 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.131 Resource', 'X-Amz-Date': b'20240807T075040Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=kiIxDzwTdJOxY2GxPJs3/20240807/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=b222355c31a90a93a7ed23d9fd5164a225d92fa3ef4b8490f88657d3ba4a73df', 'amz-sdk-invocation-id': b'06b2bc31-ea48-45a2-88f5-704baa4831ca', 'amz-sdk-request': b'attempt=5; max=5', 'Content-Length': '0'}>
[2024-08-07T07:51:11.010+0000] {logging_mixin.py:188} WARNING - 2024-08-07 07:51:11,009 botocore.hooks [DEBUG] Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:51:11.009+0000] {hooks.py:238} DEBUG - Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa6d30080>
[2024-08-07T07:51:11.012+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-08-07T07:51:11.013+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
http.client.BadStatusLine: ÿ       

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
                      ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py", line 445, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 313, in _read_status
    raise BadStatusLine(line)
urllib3.exceptions.ProtocolError: ('Connection aborted.', BadStatusLine('ÿ\x00\x00\x00\x00\x00\x00\x00\x01\x7f'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/test.py", line 43, in pred_Categorical
    s3.create_bucket(Bucket='my-bucket-name')
  File "/home/airflow/.local/lib/python3.12/site-packages/boto3/resources/factory.py", line 581, in do_action
    response = action(self, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/boto3/resources/action.py", line 88, in __call__
    response = getattr(parent.meta.client, operation_name)(*args, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/client.py", line 565, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/client.py", line 1001, in _make_api_call
    http, parsed_response = self._make_request(
                            ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/client.py", line 1027, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 202, in _send_request
    while self._needs_retry(
          ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 354, in _needs_retry
    responses = self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
               ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 207, in __call__
    if self._checker(**checker_kwargs):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 284, in __call__
    should_retry = self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 320, in _should_retry
    return self._checker(attempt_number, response, caught_exception)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 363, in __call__
    checker_response = checker(
                       ^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/botocore/httpsession.py", line 503, in send
    raise ConnectionClosedError(
botocore.exceptions.ConnectionClosedError: Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".
[2024-08-07T07:51:11.027+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=test, task_id=pred_Categorical, run_id=manual__2024-08-07T07:48:31.858098+00:00, execution_date=20240807T074831, start_date=20240807T074834, end_date=20240807T075111
[2024-08-07T07:51:11.036+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 859 for task pred_Categorical (Connection was closed before we received a valid response from endpoint URL: "http://host.docker.internal:9001/my-bucket-name".; 1636)
[2024-08-07T07:51:11.071+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 1
[2024-08-07T07:51:11.081+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-08-07T07:51:11.082+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
